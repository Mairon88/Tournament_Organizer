{% extends 'base.html' %}

{% block title %} DETALE {% endblock %}

{% block content %}

    <div class="cup_info">
        <h1 class="title"> {{ tournament.name }} </h1>
        <h2>Oragnizator turnieju: {{ tournament.author }}</h2>
        {% if tournament.tournament_status == "complete" %}
            <h2>ZWYCIĘZCĄ TURNIEJU JEST: {{ winner }}</h2>
        {% endif %}
        {% if tournament.tournament_status == "ongoing" %}
            <p> Data rozpoczęcia turnieju: {{ tournament.start_date }}</p>
        {% elif tournament.tournament_status == "complete" %}
            <p> Data zakończenia turnieju: {{ tournament.end_date }}</p>
        {% elif tournament.tournament_status == "waiting" %}
            <p> Data dodania turnieju: {{ tournament.created }}</p>
        {% endif %}
        <p> Status turnieju: {% if tournament.tournament_status == "waiting" %} Nierozpoczęty</p>
                            <p> {% elif tournament.tournament_status == "complete" %} Zakończony</p>
                            <p> {% else %} Trwa </p>
                            {% endif %}

        <p class="desc"> Opis turnieju: {{ tournament.description|linebreaks }}</p>
        <div class="players">
            {% if not players %}
                <p> Gracze / Drużyny: Brak</p>
            {% else %}
               <p> Gracze / Drużyny: </p>
            {% endif %}
        </div>
    </div>

    <div class="cointainer_player">
        {% for player in players %}
            <div class="player">
                <div class="number">{{forloop.counter}}</div><div class="name"> {{ player.name }}</div>
                {% if tournament.tournament_status == "waiting" and user.is_authenticated %}
                    <div class="del"><form method="POST">
                        <button name="delete_items" type="submit" value="{{ player.pk }}">X</button>
                        {% csrf_token %}
                    </form></div>
                {% else %}
                    <div class="del"></div>
                {% endif %}
            </div>

        {% endfor %}
    </div>
    <hr>
    {% for match in match_detail %}
            {% if not match.player_team_1 or not match.player_team_2 %}
                <p>Nazwa meczu: {{match.phase}} </p>

            {% else %}
                <p>Faza turnieju:<a href="{{ match.get_absolute_url }}"> {{match.phase}}</a></p>
            {% endif %}
            {% if match.score_1 != none and match.score_2 != none %}
                <p> Gracz/Drużyna: {{ match.player_team_1 }}, Punkty: {{ match.score_1 }} </p>
                <p> Gracz/Drużyna: {{ match.player_team_2 }}, Punkty: {{ match.score_2 }} </p>
            {% else %}
                <p> Gracz/Drużyna: {{ match.player_team_1 }}, Punkty: -</p>
                <p> Gracz/Drużyna: {{ match.player_team_2 }}, Punkty: -</p>
            {% endif %}
    {% endfor %}
    <div class="add_buttons">
        <div class="mess" >{{ message }}</div>
        {% if tournament.num_of_players > players|length and tournament.tournament_status == "waiting" and user.is_authenticated %}
            <form class="add_player" action="." method="POST">
                <div class="player_forms">{{ player_team_form.as_p }}</div>
                 {% csrf_token %}
                <div><input  type="image" name="submit" src="/media/img/add.png"  alt="Submit" /></div>
            </form>
        {% endif %}
    </div>
    <div class="other_buttons">
        {% if tournament.tournament_status == "waiting" and tournament.num_of_players == players|length and user.is_authenticated %}
            <form class="add_player" action="start/" method="POST">
                {% csrf_token %}
                <input class="save" type="image" name="submit" src="/media/img/start.png"  alt="Submit" />
            </form>
        {% endif %}
        {% if tournament.tournament_status == "ongoing" and user.is_authenticated %}
            <form class="add_player" action="complete/" method="POST">
                {% csrf_token %}
               <input class="save" type="image" name="submit" src="/media/img/stop.png"  alt="Submit" />
            </form>
        {% endif %}
        {% if tournament.tournament_status == "waiting" and user.is_authenticated %}
            <form class="add_player" action="edit/" method="POST">
                {% csrf_token %}
                <input class="save" type="image" name="submit" src="/media/img/edit.png"  alt="Submit" />
            </form>
        {% endif %}
        {% if user.is_authenticated %}
            <form class="add_player" action="delete/" method="POST">
                {% csrf_token %}
                <input class="save" type="image" name="submit" src="/media/img/delete.png"  alt="Submit" />
            </form>
        {% endif %}
        {% if tournament.tournament_status == "waiting"%}
            <p class="add_player"><a href="{% url 'waiting_tournaments' %}"><input class="back" type="image" src="/media/img/back.png"></a></p>
        {% elif tournament.tournament_status == "ongoing"%}
            <p class="add_player"><a href="{% url 'ongoing_tournaments' %}"><input class="back" type="image" src="/media/img/back.png"></a></p>
        {% else %}
            <p class="add_player"><a href="{% url 'completed_tournaments' %}"><input class="back" type="image" src="/media/img/back.png"></a></p>
        {% endif %}
    </div>
{% endblock %}